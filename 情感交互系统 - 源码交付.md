# 情感交互系统 - 源码交付

## 📦 包含内容

本压缩包包含了完整的情感交互系统源码：

```
emotion_system_showcase_source.tar.gz (115KB)
├── client/                    # 前端React应用
│   ├── src/
│   │   ├── pages/            # 页面组件
│   │   ├── components/       # UI组件
│   │   └── lib/              # 工具库
│   └── index.html
├── server/                    # 后端Express服务
│   ├── routers.ts            # API路由定义
│   ├── db.ts                 # 数据库操作
│   └── _core/                # 核心框架
├── drizzle/                   # 数据库schema和迁移
├── shared/                    # 共享类型和常量
├── package.json              # 项目依赖
├── vite.config.ts            # Vite配置
└── tsconfig.json             # TypeScript配置
```

## 🚀 快速开始

### 方式1：使用快速启动脚本（推荐）

```bash
# 赋予脚本执行权限
chmod +x QUICK_START.sh

# 运行脚本
./QUICK_START.sh
```

### 方式2：手动启动

```bash
# 1. 解压源码
tar -xzf emotion_system_showcase_source.tar.gz
cd emotion_system_showcase

# 2. 安装依赖
pnpm install

# 3. 初始化数据库
pnpm db:push

# 4. 启动开发服务器
pnpm dev

# 访问 http://localhost:3000
```

## 📋 系统要求

- **Node.js**: 18.0+
- **npm/pnpm**: 最新版本
- **MySQL**: 5.7+ 或 8.0+
- **内存**: 2GB+
- **硬盘**: 5GB+

## 🔧 环境配置

### 1. 数据库配置

创建 `.env` 文件：

```env
DATABASE_URL="mysql://root:password@localhost:3306/emotion_db"
```

### 2. OAuth配置（可选）

如需使用Manus OAuth认证：

```env
VITE_APP_ID=your_app_id
OAUTH_SERVER_URL=https://api.manus.im
VITE_OAUTH_PORTAL_URL=https://auth.manus.im
JWT_SECRET=your_secret_key
```

### 3. 应用配置

```env
VITE_APP_TITLE="情感交互系统"
NODE_ENV=development
PORT=3000
```

## 📚 项目结构

### 前端 (React + TypeScript)
- **Home.tsx** - 登录和主页
- **App.tsx** - 实时检测界面（摄像头 + 语音）
- **Settings.tsx** - 用户设置
- **History.tsx** - 检测历史

### 后端 (Express + tRPC)
- **routers.ts** - API路由定义
- **routers/emotion.ts** - 情感检测API
- **db.ts** - 数据库查询函数
- **_core/index.ts** - 服务器入口

### 数据库 (MySQL + Drizzle ORM)
- **users** - 用户表
- **userSettings** - 用户设置表
- **emotionHistory** - 检测历史表
- **customResponses** - 自定义回应表

## 🎯 核心功能

### 1. 实时摄像头检测
- 访问用户摄像头
- 实时视频流显示
- 表情检测（模拟）

### 2. 语音识别
- Web Speech API语音识别
- 中文语音支持
- 实时转录显示

### 3. 智能回应
- 根据表情生成回应
- 多个预设回应库
- 自定义回应支持

### 4. 语音合成
- Web Speech API文字转语音
- 语速调节
- 音量控制

### 5. 用户系统
- OAuth认证
- 个人设置保存
- 检测历史记录

## 🛠️ 常用命令

```bash
# 开发环境
pnpm dev              # 启动开发服务器

# 生产环境
pnpm build            # 构建项目
pnpm start            # 启动生产服务器

# 数据库
pnpm db:push          # 运行数据库迁移

# 测试
pnpm test             # 运行单元测试

# 代码检查
pnpm check            # TypeScript类型检查
pnpm format           # 代码格式化
```

## 📖 详细部署指南

请查看 `DEPLOYMENT_GUIDE.md` 了解：
- 完整的部署步骤
- Nginx配置
- Docker部署
- 性能优化
- 故障排除

## 🔐 安全建议

1. **环境变量** - 不要提交 `.env` 文件到版本控制
2. **HTTPS** - 生产环境必须使用HTTPS
3. **数据库** - 使用强密码，定期备份
4. **防火墙** - 只开放必要的端口
5. **依赖更新** - 定期更新npm依赖

## 📊 技术栈

| 层级 | 技术 | 版本 |
|------|------|------|
| 前端框架 | React | 19.2 |
| 前端样式 | Tailwind CSS | 4.1 |
| 前端构建 | Vite | 7.1 |
| 后端框架 | Express | 4.21 |
| API框架 | tRPC | 11.6 |
| 数据库ORM | Drizzle | 0.44 |
| 数据库 | MySQL | 5.7+ |
| 认证 | Manus OAuth | - |
| 语言 | TypeScript | 5.9 |

## 🐛 常见问题

**Q: 如何修改表情检测的回应？**
A: 编辑 `client/src/pages/App.tsx` 中的 `DEFAULT_RESPONSES` 对象

**Q: 如何集成真实的YOLOv11模型？**
A: 需要创建Python后端服务，通过API调用返回检测结果

**Q: 如何修改语音识别的语言？**
A: 修改 `client/src/pages/App.tsx` 中的 `recognition.lang` 属性

**Q: 如何添加新的用户设置选项？**
A: 在 `drizzle/schema.ts` 中扩展 `userSettings` 表

## 📞 技术支持

- 查看项目文档：`README.md`
- 查看部署指南：`DEPLOYMENT_GUIDE.md`
- 查看源码注释了解实现细节

## 📄 许可证

MIT License

## 🎉 开始使用

1. 解压源码包
2. 运行快速启动脚本或手动安装
3. 访问 http://localhost:3000
4. 使用系统进行情感交互

祝您使用愉快！
